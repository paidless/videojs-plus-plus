{"version":3,"file":"index.js","sources":["../../../source/Utils/Promise.js","../../../source/Plugin/ExtraFullwindowToggle/ExtraFullwindowToggle.js"],"sourcesContent":["\n/**\n * Returns whether an object is `Promise`-like (i.e. has a `then` method).\n *\n * @param  {Object}  value\n *         An object that may or may not be `Promise`-like.\n *\n * @return {boolean}\n *         Whether or not the object is `Promise`-like.\n */\nexport function isPromise(value) {\n  return value !== undefined && value !== null && typeof value.then === 'function';\n}\n\n/**\n * Silence a Promise-like object.\n *\n * This is useful for avoiding non-harmful, but potentially confusing \"uncaught\n * play promise\" rejection error messages.\n *\n * @param  {Object} value\n *         An object that may or may not be `Promise`-like.\n */\nexport function silencePromise(value) {\n  if (isPromise(value)) {\n    value.then(null, (e) => { });\n  }\n}\n","import videojs from 'video.js';\nimport { silencePromise } from '../../Utils/Promise';\nimport './ExtraFullwindowToggle.scss';\n\nconst Button = videojs.getComponent('Button');\n\nclass FullWindowToggle extends Button {\n\n  /**\n   * Create a Full window toggle button instance.\n   *\n   * @param     {Player} player\n   *            A Video.js Player instance.\n   *\n   * @param     {Object} [options]\n   *            An optional options object.\n   */\n  constructor(player, options) {\n    super(player, options);\n\n    this.updateButtonState();\n\n    // Patches exitFullscreenHelper\n    // Code from: https://github.com/paidless/videojs-yt-style/blob/7b6f1620b5c925d4a4a602df83b0b58d1b0d5843/src/js/features/fullwindow-toggle-manager.js#L11-L33\n    // Ref: https://github.com/videojs/video.js/blob/9ca2e8764a2cced1efdad730b8c66c4b42a33f7f/src/js/player.js#L2976-L2992\n    player.exitFullscreenHelper_ = function exitFullscreenHelper_() {\n      if (this.isFullWindow) {\n        return this.exitFullWindow();\n      }\n  \n      if (this.fsApi_.requestFullscreen) {\n        const promise = document[this.fsApi_.exitFullscreen]();\n  \n        if (promise) {\n          // we're splitting the promise here, so, we want to catch the\n          // potential error so that this chain doesn't have unhandled errors\n          silencePromise(promise.then(function() {\n            return this.isFullscreen(false);\n          }));\n        }\n  \n        return promise;\n      } else if (this.tech_.supportsFullScreen() && !this.options_.preferFullWindow === true) {\n        this.techCall_('exitFullScreen');\n      } else {\n        this.exitFullWindow();\n      }\n    };\n\n    const events = ['enterFullWindow', 'exitFullWindow', 'fullscreenchange'];\n    const handleFullWindowChange = (event) => {\n      this.updateButtonState.call(this);\n\n      if (!this.player_.isFullscreen()) {\n        this.show();\n      } else {\n        this.hide();\n      }\n\n      if (event.type !== 'fullscreenchange') {\n        const fullscreenToggle = this.getFullscreenToggle();\n        if (fullscreenToggle) {\n          fullscreenToggle.handleFullscreenChange();\n        }\n\n        player.trigger('fullwindowchange');\n      }\n    }\n\n    player.on(events, handleFullWindowChange);\n    player.on('dispose', () => {\n      player.off(events, handleFullWindowChange);\n    });\n  }\n\n  getFullscreenToggle() {\n    const findComponents = this.player_.findChild('fullscreenToggle');\n\n    if (findComponents.length > 0) {\n      return findComponents[0].component;\n    }\n  }\n\n  /**\n   * Set button css class.\n   *\n   * @return    {string}\n   *            Return css class.\n   */\n  buildCSSClass() {\n    return `vjs-fullwindow-control ${super.buildCSSClass()}`;\n  }\n\n  /**\n   * Button click handle.\n   *\n   * \n   * @param     {Object} [event]\n   *            Event data.\n   */\n  handleClick(event) {\n    if (!this.player_.isFullWindow) {\n      this.player_.enterFullWindow();\n    } else {\n      this.player_.exitFullWindow();\n    }\n\n    this.updateButtonState();\n  }\n\n  /**\n   * Button state update.\n   */\n  updateButtonState() {\n    if (!this.player_.isFullWindow) {\n      this.controlText('Fullwindow');\n    } else {\n      this.controlText('Exit Fullwindow');\n    }\n  }\n}\n\nvideojs.registerComponent('FullWindowToggle', FullWindowToggle);\n\nconst controlBarChildren = videojs.getComponent('ControlBar').prototype.options_\n  .children;\nconst fullScreenButtonIndex = controlBarChildren.indexOf('FullscreenToggle');\n\ncontrolBarChildren.splice(fullScreenButtonIndex, 0, 'FullWindowToggle');\n"],"names":["isPromise","value","undefined","then","silencePromise","e","Button","videojs","getComponent","FullWindowToggle","player","options","updateButtonState","exitFullscreenHelper_","isFullWindow","exitFullWindow","fsApi_","requestFullscreen","promise","document","exitFullscreen","isFullscreen","tech_","supportsFullScreen","options_","preferFullWindow","techCall_","events","handleFullWindowChange","event","call","player_","show","hide","type","fullscreenToggle","getFullscreenToggle","handleFullscreenChange","trigger","on","off","findComponents","findChild","length","component","buildCSSClass","handleClick","enterFullWindow","controlText","registerComponent","controlBarChildren","prototype","children","fullScreenButtonIndex","indexOf","splice"],"mappings":"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"}